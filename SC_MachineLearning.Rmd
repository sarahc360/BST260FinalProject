---
title: "SC_MachineLearning"
output: html_document
---

Model "total length of paid maternity and parental leave" by using knn, qda, and lda models. Find the best fitting model. 

```{r}
library(fastDummies)
library(dplyr)

# Use to create variables of interest
scdat <- t1 %>% filter(Age.Group == "Total")

# Outcome of interest: PMLeave (Total length of paid maternity and parental leave)
scdatTPMPL <- scdat %>% 
  filter(Indicator == "Total length of paid maternity and parental leave") %>%
  mutate(TPMPL = Value) %>%
  select(Country, Time, TPMPL)

# Predictors: (all are related to women in the workforce and women in policy making positions)
# LFRm_w (Labour force participation ratio (men/women)) 
scdatLFRm_w <- scdat %>% 
  filter(Indicator == "Labour force participation rate, by sex and age group ") %>% 
  spread(Sex, Value) %>% 
  mutate(LFRm_w = Men/Women) %>%
  select(Country, Time, LFRm_w)

# FNP (female share of seats in national parliaments)
scdatFNP <- scdat %>% 
  filter(Indicator == "Female share of seats in national parliaments") %>%
  mutate(FNP = Value) %>%
  select(Country, Time, FNP)

# FM (share of female managers)
scdatFM <- scdat %>%
  filter(Indicator == "Share of female managers") %>%
  mutate(FM = Value) %>%
  select(Country, Time, FM)

# FBS (female share of seats on boards of the largest publicly listed companies)
scdatFBS <- scdat %>% 
  filter(Indicator == "Female share of seats on boards of the largest publicly listed companies") %>% 
  mutate(FBS = Value) %>%
  select(Country, Time, FBS)

# Year 
# (Time variable)

# Add all variables created above into a final dataframe
scdata_list <- list(scdatTPMPL, scdatLFRm_w, scdatFNP, scdatFM, scdatFBS)
scdatALL <- scdata_list %>% 
  reduce(left_join, by = c("Country", "Time")) %>% 
  select(Country, Time, TPMPL, LFRm_w, FNP, FM, FBS)

# Finally, add dummy variables for Country to use in modeling
scdatALL <- dummy_cols(scdatALL, select_columns = "Country")
# (Use only Country_Australia through Country_United Kingdom with Country_UnitedStates as the referent)

# Convert Time to be a numeric variable
scdatALL$Time <- as.numeric(scdatALL$Time)
```

Now that we have our data cleaned, we can fit our machine learning models. 






