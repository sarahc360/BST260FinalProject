---
title: "SC_MachineLearning"
output: html_document
---

Model "total length of paid maternity and parental leave" by using knn, qda, and lda models. Find the best fitting model. 

```{r}
library(fastDummies)
library(dplyr)

# set working directory to where you stored the .csv file
setwd("/Users/sarahchristensen/Documents/Harvard/Fall2021/BST260/BST260FinalProject") 

# set up t1 dataframe (from ReadInData.Rmd)
t1 <- read.csv("data1.csv")
t1 <- t1 %>% 
  select(Country, IND, Indicator, Sex, Age.Group, Time, Value, Unit, Flags)

OECD_label <- c("Australia", "Austria", "Belgium", "Canada", "Chile", "Colombia", "Costa Rica", "Czech Republic", "Denmark", "Estonia", "Finland", "France", "Germany", "Greece", "Hungary", "Iceland", "Ireland", "Israel", "Italy", "Japan", "Korea", "Latvia", "Lithuania", "Luxembourg", "Mexico", "Netherlands", "New Zealand", "Norway", "Poland", "Portugal", "Slovak Republic", "Slovenia", "Spain", "Sweden", "Switzerland", "Turkey", "United Kingdom", "United States")

t1 <- t1 %>%
  filter (Country %in% OECD_label)

# Use to create variables of interest
scdat <- t1 %>% filter(Age.Group == "Total")

# Outcome of interest: PMLeave (Total length of paid maternity and parental leave)
scdatTPMPL <- scdat %>% 
  filter(Indicator == "Total length of paid maternity and parental leave") %>%
  mutate(PMLeave = Value)

# Predictors: (all are related to women in the workforce and women in policy making positions)
# LFRm_w (Labour force participation ratio (men/women)) 
scdatLFR <- scdat %>% 
  filter(Indicator == "Labour force participation rate, by sex and age group ") %>% 
  spread(Sex, Value) %>% 
  mutate(LFRm_w = Men/Women)

# FNP (female share of seats in national parliaments)
scdatFNP <- scdat %>% 
  filter(Indicator == "Female share of seats in national parliaments") %>%
  mutate(FNP = Value)

# FM (share of female managers)
scdatFM <- scdat %>%
  filter(Indicator == "Share of female managers") %>%
  mutate(FM = Value)

# FBS (female share of seats on boards of the largest publicly listed companies)
scdatFBS <- scdat %>% 
  filter(Indicator == "Female share of seats on boards of the largest publicly listed companies") %>% 
  mutate(FBS = Value)

# Year (Time variable)

# Add all variables created above into a final dataframe
scdatALL <- scdat
scdatALL <- left_join(scdatALL, scdatTPMPL, by = c("Country", "Time", "Age.Group")) 

# Finally, add dummy variables for Country to use in modeling
scdatALL <- dummy_cols(scdatALL, select_columns = "Country")
# Use only Country_Australia through Country_United Kingdom with Country_UnitedStates as the referent


unique(t1$Indicator)




```

